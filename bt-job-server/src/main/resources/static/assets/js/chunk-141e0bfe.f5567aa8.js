(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-141e0bfe"],{"098f":function(e,t,a){},"7a9e":function(e,t,a){"use strict";a("be27")},9709:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",[a("el-header",{staticClass:"header"},[a("span",{staticClass:"title"},[e._v("任务管理")])]),a("el-container",[a("el-header",[a("el-row",{attrs:{gutter:24,type:"flex"}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"label_content"},[a("span",[e._v("任务名")]),a("el-input",{attrs:{placeholder:"请输入任务名",maxlength:"25","show-word-limit":"",clearable:""},model:{value:e.params.taskName,callback:function(t){e.$set(e.params,"taskName",t)},expression:"params.taskName"}})],1)]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"label_content"},[a("span",[e._v("服务名")]),a("el-input",{attrs:{placeholder:"请输入服务名",maxlength:"25","show-word-limit":"",clearable:""},model:{value:e.params.appName,callback:function(t){e.$set(e.params,"appName",t)},expression:"params.appName"}})],1)]),a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"primary",loading:e.loading,icon:"el-icon-search"},on:{click:e.search}},[e._v("查询")]),a("el-button",{attrs:{type:"info",icon:"el-icon-circle-plus-outline"},on:{click:e.newTask}},[e._v("增加任务")])],1)],1)],1),a("el-main",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data,"max-height":"580px","cell-style":{"text-align":"center"},"header-cell-style":{"text-align":"center","background-color":"#f5f7fa"}}},[a("template",{slot:"empty"},[a("span",[e._v("暂无任务信息")])]),a("el-table-column",{attrs:{prop:"taskName",label:"任务名","min-width":"120"}}),a("el-table-column",{attrs:{prop:"desc",label:"任务描述","min-width":"120"}}),a("el-table-column",{attrs:{prop:"appName",label:"服务名","min-width":"100"}}),a("el-table-column",{attrs:{prop:"serveHost",label:"当前触发server","min-width":"100"}}),a("el-table-column",{attrs:{prop:"executeType",label:"执行类型","min-width":"100"}}),a("el-table-column",{attrs:{prop:"timeType",label:"触发方式","min-width":"100"}}),a("el-table-column",{attrs:{prop:"timeVal",label:"时间表达式","min-width":"100"}}),a("el-table-column",{attrs:{prop:"lastTriggerTime",label:"最后触发时间","min-width":"150"}}),a("el-table-column",{attrs:{prop:"nextTriggerTime",label:"下次触发时间","min-width":"150"}}),a("el-table-column",{attrs:{prop:"crt",label:"创建时间","min-width":"150"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.taskInstance(t.row)}}},[e._v("查看")])]}}])})],2),a("el-pagination",{attrs:{"hide-on-single-page":!0,background:"","page-size":e.pageSize,"page-sizes":[10,20,50],disabled:e.loading,"current-page":e.page,total:e.total,layout:"total, sizes,prev, pager, next"},on:{"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1)],1)],1),a("new-task",{ref:"newTask",on:{reload:e.reload}})],1)},s=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.visible,title:"新增任务",top:"5vh",width:"45%"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px",rules:e.rules}},[a("el-form-item",{attrs:{label:"任务名",prop:"taskName"}},[a("el-input",{attrs:{maxlength:"25","show-word-limit":"",clearable:"",placeholder:"请输入任务名"},model:{value:e.form.taskName,callback:function(t){e.$set(e.form,"taskName",t)},expression:"form.taskName"}})],1),a("el-form-item",{attrs:{label:"任务描述",prop:"des"}},[a("el-input",{attrs:{maxlength:"120","show-word-limit":"",clearable:"",placeholder:"请输入任务描述"},model:{value:e.form.des,callback:function(t){e.$set(e.form,"des",t)},expression:"form.des"}})],1),a("el-form-item",{attrs:{label:"服务名",prop:"appName"}},[a("el-input",{attrs:{maxlength:"25","show-word-limit":"",clearable:"",placeholder:"请输入服务名"},model:{value:e.form.appName,callback:function(t){e.$set(e.form,"appName",t)},expression:"form.appName"}})],1),a("el-form-item",{attrs:{label:"执行类型",prop:"timeType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.timeType,callback:function(t){e.$set(e.form,"timeType",t)},expression:"form.timeType"}},[a("el-option",{attrs:{label:"corn 表达式",value:"CORN"}}),a("el-option",{attrs:{label:"固定频率",value:"FIX_RATE"}}),a("el-option",{attrs:{label:"延时执行",value:"DELAY"}}),a("el-option",{attrs:{label:"固定时间",value:"FIX_DATE"}})],1)],1),a("el-form-item",{attrs:{label:"执行表达式",prop:"timeExpression"}},[a("el-input",{attrs:{maxlength:"25","show-word-limit":"",clearable:"",placeholder:"执行表达式"},model:{value:e.form.timeExpression,callback:function(t){e.$set(e.form,"timeExpression",t)},expression:"form.timeExpression"}}),a("el-tooltip",{staticStyle:{"margin-left":"20px"},attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. 执行类型为corn，请输入corn表达式"),a("br"),e._v(" 2. 执行类型为固定频率和延时执行，请输入毫秒数，最小1000ms"),a("br"),e._v(" 3. 执行类型为固定时间，请输入时间类型，格式 yyyy-MM-dd HH:mm:ss ")]),a("i",{staticClass:"el-icon-info"})])],1),a("el-form-item",{attrs:{label:"任务执行类型",prop:"executeType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.executeType,callback:function(t){e.$set(e.form,"executeType",t)},expression:"form.executeType"}},[a("el-option",{attrs:{label:"单机执行",value:"SINGLE"}}),a("el-option",{attrs:{label:"广播执行",value:"BROADCAST"}})],1)],1),a("el-form-item",{attrs:{label:"任务类型",prop:"taskType"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.taskType,callback:function(t){e.$set(e.form,"taskType",t)},expression:"form.taskType"}},[a("el-option",{attrs:{label:"客户端",value:"REMOTE_CLIENT"}}),a("el-option",{attrs:{label:"Shell脚本",value:"SHELL"}})],1)],1),a("el-form-item",{attrs:{label:"任务元信息",prop:"jobMeta"}},[a("el-input",{attrs:{maxlength:"2000","show-word-limit":"",type:"textarea",rows:5,placeholder:"请填写任务信息"},model:{value:e.form.jobMeta,callback:function(t){e.$set(e.form,"jobMeta",t)},expression:"form.jobMeta"}}),a("el-tooltip",{staticStyle:{"margin-left":"20px"},attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 1. shell脚本执行时，请填写shell脚本信息"),a("br"),e._v(" 2. 普通任务执行时，该项可作为任务参数"),a("br")]),a("i",{staticClass:"el-icon-info"})])],1),a("el-form-item",[a("el-button",{attrs:{type:"info",loading:e.load},on:{click:e.cancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",loading:e.load},on:{click:e.confirm}},[e._v("确定")])],1)],1)],1)],1)},i=[],o=a("f96b"),n={name:"newTask",data(){return{visible:!1,load:!1,form:{taskName:"",des:"",appName:"",timeType:"",timeExpression:"",executeType:"",taskType:"",jobMeta:""},rules:{taskName:[{max:25,message:"任务名长度最大25个字符",trigger:"blur"}],des:[{required:!0,message:"请输入任务描述信息",trigger:"blur"},{max:120,message:"任务描述长度最大120个字符",trigger:"blur"}],appName:[{required:!0,message:"请输入服务名",trigger:"blur"},{max:25,message:"服务名长度最大25个字符",trigger:"blur"}],timeType:[{required:!0,message:"请选择执行类型",trigger:"blur"}],timeExpression:[{required:!0,message:"请输入执行表达式",trigger:"blur"},{max:25,message:"执行表达式长度最大25个字符",trigger:"blur"}],executeType:[{required:!0,message:"请选择任务执行类型",trigger:"blur"}],taskType:[{required:!0,message:"请选择任务类型",trigger:"blur"}],jobMeta:[{max:2e3,message:"任务元信息长度最大2000=个字符",trigger:"blur"}]}}},methods:{confirm(){this.load=!0,this.$refs.form.validate(e=>{e?Object(o["addTask"])(this.form).then(e=>{this.$message({message:"增加任务成功",type:"success"}),this.visible=!1,this.$nextTick(()=>{this.load=!1,this.$refs.form.resetFields(),this.$emit("reload")})}).catch(e=>{var t=e.response.data;this.$message({message:""+t.message,type:"error"})}).finally(()=>{this.load=!1}):this.load=!1})},cancel(){this.load=!0,this.visible=!1,this.$nextTick(()=>{this.load=!1,this.$refs.form.resetFields()})}}},p=n,m=(a("7a9e"),a("2877")),c=Object(m["a"])(p,r,i,!1,null,null,null),u=c.exports,d={components:{newTask:u},data(){return{params:{},data:[],loading:!1,page:0,pageSize:10,total:0}},mounted(){this.search()},methods:{search(){this.loading=!0,this.$api.getTask({...this.params,current:this.page-1,pageSize:this.pageSize}).then(e=>{this.total=e.data.total,this.data=e.data.data}).catch(e=>{console.log(e)}).finally(()=>{this.loading=!1})},reload(){this.page=1,this.search()},handleCurrentChange(e){this.search()},handleSizeChange(e){this.page=0,this.search()},taskInstance(e){this.$router.push({name:"task-instance",query:{taskId:e.id}})},newTask(){this.$refs.newTask.visible=!0}}},h=d,b=(a("ad27"),Object(m["a"])(h,l,s,!1,null,null,null));t["default"]=b.exports},ad27:function(e,t,a){"use strict";a("098f")},be27:function(e,t,a){}}]);
//# sourceMappingURL=chunk-141e0bfe.f5567aa8.js.map